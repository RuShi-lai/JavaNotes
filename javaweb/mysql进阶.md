#### MySQLæ¶æ„

##### 	mysqlçš„ç³»ç»Ÿæ¶æ„

æ•°æ®åº“å’Œæ•°æ®åº“å®ä¾‹

- æ•°æ®åº“ï¼šæŒ‰ç…§æ•°æ®ç»“æ„æ¥ç»„ç»‡ã€å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“ï¼Œé€šå¸¸ç”±æ•°æ®åº“ç®¡ç†ç³»ç»Ÿè¿›è¡Œç®¡ç†ã€‚
- æ•°æ®åº“ç®¡ç†è½¯ä»¶ï¼ˆRDBMSï¼‰ï¼šå°±æ˜¯æˆ‘ä»¬è¯´çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿè½¯ä»¶ï¼Œä»–å¼ºè°ƒè½¯ä»¶ã€‚
- æ•°æ®åº“å®ä¾‹ï¼šå¯åŠ¨æ•°æ®åº“è½¯ä»¶ï¼Œåœ¨å†…å­˜ä¸­è¿è¡Œä¸€ä¸ªç‹¬ç«‹è¿›ç¨‹ï¼Œç”¨æ¥æ“ä½œæ•°æ®ï¼Œè¿™ä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å°±æ˜¯ä¸€ä¸ªæ•°æ®åº“å®ä¾‹ï¼Œç†è®ºä¸Šå¯ä»¥åœ¨ä¸€å°ç”µè„‘ä¸Šå¯åŠ¨å¤šä¸ªæ•°æ®åº“å®ä¾‹ï¼Œå½“ç„¶è¦ç›‘å¬åœ¨ä¸åŒçš„ç«¯å£

mysqlæ¶æ„

**ï¼ˆ1ï¼‰MySQLå‘å¤–æä¾›çš„äº¤äº’æ¥å£ï¼ˆConnectorsï¼‰**

Connectorsç»„ä»¶ï¼Œæ˜¯MySQLå‘å¤–æä¾›çš„äº¤äº’ç»„ä»¶ï¼Œå¦‚java,.net,phpç­‰è¯­è¨€å¯ä»¥é€šè¿‡è¯¥ç»„ä»¶æ¥æ“ä½œSQLè¯­å¥ï¼Œå®ç°ä¸SQLçš„äº¤äº’ã€‚é€šè¿‡å®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡åè®®ä¸MySQLå»ºç«‹è¿æ¥ã€‚MySQL å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„é€šä¿¡æ–¹å¼æ˜¯ â€œ åŠåŒå·¥ â€ã€‚å¯¹äºæ¯ä¸€ä¸ª MySQL çš„è¿æ¥ï¼Œæ—¶åˆ»éƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹çŠ¶æ€æ¥æ ‡è¯†è¿™ä¸ªè¿æ¥æ­£åœ¨åšä»€ä¹ˆã€‚

**ï¼ˆ2ï¼‰ç®¡ç†æœåŠ¡ç»„ä»¶å’Œå·¥å…·ç»„ä»¶(Management Service & Utilities)**

æä¾›MySQLçš„å„é¡¹æœåŠ¡ç»„ä»¶å’Œç®¡ç†å·¥å…·ï¼Œå¦‚å¤‡ä»½(Backup)ï¼Œæ¢å¤(Recovery)ï¼Œå®‰å…¨ç®¡ç†(Security)ç­‰åŠŸèƒ½ã€‚

**ï¼ˆ3ï¼‰è¿æ¥æ± ç»„ä»¶(Connection Pool)**

è´Ÿè´£ç›‘å¬å®¢æˆ·ç«¯å‘MySQL Serverç«¯çš„å„ç§è¯·æ±‚ï¼Œæ¥æ”¶è¯·æ±‚ï¼Œè½¬å‘è¯·æ±‚åˆ°ç›®æ ‡æ¨¡å—ã€‚æ¯ä¸ªæˆåŠŸè¿æ¥MySQL Serverçš„å®¢æˆ·è¯·æ±‚éƒ½ä¼šè¢«åˆ›å»ºæˆ–åˆ†é…ä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹è´Ÿè´£å®¢æˆ·ç«¯ä¸MySQL Serverç«¯çš„é€šä¿¡ï¼Œæ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„å‘½ä»¤ï¼Œä¼ é€’æœåŠ¡ç«¯çš„ç»“æœä¿¡æ¯ç­‰ã€‚

**ï¼ˆ4ï¼‰SQLæ¥å£ç»„ä»¶(SQL Interface)**

æ¥æ”¶ç”¨æˆ·SQLå‘½ä»¤ï¼Œå¦‚DML,DDLå’Œå­˜å‚¨è¿‡ç¨‹ç­‰ï¼Œå¹¶å°†æœ€ç»ˆç»“æœè¿”å›ç»™ç”¨æˆ·ã€‚

**ï¼ˆ5ï¼‰æŸ¥è¯¢åˆ†æå™¨ç»„ä»¶(Parser)**

é¦–å…ˆåˆ†æSQLå‘½ä»¤è¯­æ³•çš„åˆæ³•æ€§ï¼Œå¹¶è¿›è¡ŒæŠ½è±¡è¯­æ³•æ ‘è§£æï¼Œå¦‚æœsqlæœ‰è¯­æ³•é”™è¯¯ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ä¿¡æ¯ã€‚

**ï¼ˆ6ï¼‰ä¼˜åŒ–å™¨ç»„ä»¶ï¼ˆOptimizerï¼‰**

å¯¹SQLå‘½ä»¤æŒ‰ç…§æ ‡å‡†æµç¨‹è¿›è¡Œä¼˜åŒ–åˆ†æï¼Œmysqlä¼šæŒ‰ç…§å®ƒè®¤ä¸ºçš„æœ€ä¼˜æ–¹å¼è¿›è¡Œä¼˜åŒ–ï¼Œé€‰ç”¨æˆæœ¬æœ€å°çš„æ‰§è¡Œè®¡åˆ’ã€‚

**ï¼ˆ7ï¼‰ç¼“å­˜ä¸»ä»¶ï¼ˆCaches & Buffersï¼‰**

ç¼“å­˜å’Œç¼“å†²ç»„ä»¶ï¼Œè¿™é‡Œè¾¹çš„å†…å®¹æˆ‘ä»¬åè¾¹ä¼šè¯¦ç»†çš„è®²è§£ã€‚

**ï¼ˆ8ï¼‰MySQLå­˜å‚¨å¼•æ“**

MySQLå±äºå…³ç³»å‹æ•°æ®åº“ï¼Œè€Œå…³ç³»å‹æ•°æ®åº“çš„å­˜å‚¨æ˜¯ä»¥è¡¨çš„å½¢å¼è¿›è¡Œçš„ï¼Œå¯¹äºè¡¨çš„åˆ›å»ºï¼Œæ•°æ®çš„å­˜å‚¨ï¼Œæ£€ç´¢ï¼Œæ›´æ–°ç­‰éƒ½æ˜¯ç”±MySQLå­˜å‚¨å¼•æ“å®Œæˆçš„ã€‚

MySQLå­˜å‚¨å¼•æ“åœ¨MySQLä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚ç ”ç©¶è¿‡SQL Serverå’ŒOracleçš„è¯»è€…å¯èƒ½å¾ˆæ¸…æ¥šï¼Œè¿™ä¸¤ç§æ•°æ®åº“çš„å­˜å‚¨å¼•æ“åªæœ‰ä¸€ä¸ªï¼Œè€ŒMySQLçš„å­˜å‚¨å¼•æ“ç§ç±»æ¯”è¾ƒå¤šï¼Œå¦‚MyIsamå­˜å‚¨å¼•æ“ï¼ŒInnoDBå­˜å‚¨å¼•æ“å’ŒMemoryå­˜å‚¨å¼•æ“ã€‚

å› ä¸ºmysqlæœ¬èº«å°±æ˜¯å¼€æºçš„ï¼Œä»–å…è®¸ç¬¬ä¸‰æ–¹åŸºäºMySQLéª¨æ¶ï¼Œå¼€å‘é€‚åˆè‡ªå·±ä¸šåŠ¡éœ€æ±‚çš„å­˜å‚¨å¼•æ“ã€‚ä»MySQLå­˜å‚¨å¼•æ“ç§ç±»ä¸Šæ¥è¯´ï¼Œå¯ä»¥åˆ†ä¸ºå®˜æ–¹å­˜å‚¨å¼•æ“å’Œç¬¬ä¸‰æ–¹å­˜å‚¨å¼•æ“ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„å­˜å‚¨å¼•æ“åŒ…æ‹¬InnoDBå­˜å‚¨å¼•æ“ï¼ŒMyIsamå­˜å‚¨å¼•æ“å’ŒMomeryå­˜å‚¨å¼•æ“ã€‚

![](https://www.ydlclass.com/doc21xnv/assets/image-20220424195802351-3a69069f.png)

##### 	ç›®å½•ç»“æ„

mysqlå¯åŠ¨çš„æ—¶å€™ï¼Œä¼šä»ã€å®‰è£…ç›®å½•ã€‘åŠ è½½è½¯ä»¶æ•°æ®ï¼Œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šä»ã€æ•°æ®ç›®å½•ã€‘ä¸­è¯»å–æ•°æ®ã€‚è¿™ä¸¤ä¸ªç›®å½•æˆ‘ä»¬ä¸è¦æ”¾åœ¨ä¸€èµ·ï¼Œé¿å…é‡æ–°å®‰è£…è½¯ä»¶å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚

mysqlå®‰è£…ç›®å½•ï¼šé»˜è®¤C:\Program Files\MySQL

- `bin`ç›®å½•ï¼šç”¨äºæ”¾ç½®ä¸€äº›å¯æ‰§è¡Œçš„å·¥å…·æ–‡ä»¶ï¼Œå¦‚mysql.exeã€mysqld.exeã€mysqlshow.exeç­‰ã€‚
- `include`ç›®å½•ï¼šç”¨äºæ”¾ç½®ä¸€äº›å¤´æ–‡ä»¶ï¼Œå¦‚ï¼šmysql.hã€mysql_ername.hç­‰ã€‚
- `lib`ç›®å½•ï¼šç”¨äºæ”¾ç½®ä¸€ç³»åˆ—åº“æ–‡ä»¶ã€‚

æ•°æ®æ–‡ä»¶ç›®å½•ï¼š

é»˜è®¤æ•°æ®ç›®å½•ï¼šC:\ProgramData\MySQL\MySQL Server 8.0ï¼Œæ³¨æ„ProgramDataæ˜¯ä¸€ä¸ªéšè—ç›®å½•ï¼Œéœ€è¦è®¾ç½®ä¸ºã€æ˜¾ç¤ºéšè—æ–‡ä»¶ã€‘ï¼š

`data`ç›®å½•ï¼šç”¨äºæ”¾ç½®ä¸€äº›æ—¥å¿—æ–‡ä»¶ä»¥åŠæ•°æ®åº“ã€‚dataç›®å½•ä¿å­˜çš„æ˜¯æˆ‘ä»¬çš„çœŸæ˜¯çš„æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®åº“ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯å¼ è¡¨åˆæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“çš„æ–‡ä»¶å­˜å‚¨æ–¹å¼ä¸åŒã€‚

binç›®å½•å·¥å…·æ±‡æ€»

> MySQLæœåŠ¡å™¨ç«¯å·¥å…·

- mysqldï¼šSQLåå°ä¿æŠ¤ç¨‹åº(MySQLæœåŠ¡å™¨è¿›ç¨‹)ã€‚è¯¥ç¨‹åºå¿…é¡»è¿è¡Œä¹‹åã€‚å®¢æˆ·ç«¯æ‰èƒ½é€šè¿‡è¿æ¥æœåŠ¡å™¨ç«¯ç¨‹åºè®¿é—®å’Œæ“ä½œæ•°æ®åº“ã€‚
- mysqld_safeï¼šMySQLæœåŠ¡è„šæœ¬ã€‚mysql_safeå¢åŠ äº†ä¸€äº›å®‰å…¨ç‰¹æ€§ï¼Œå¦‚å½“å‡ºç°é”™è¯¯æ—¶é‡å¯æœåŠ¡å™¨ï¼Œå‘é”™è¯¯æ—¥å¿—æ–‡ä»¶å†™å…¥è¿è¡Œæ—¶é—´ä¿¡æ¯ã€‚
- mysql.serverï¼šMySQLæœåŠ¡å¯åŠ¨æœæœ¬ã€‚è°ƒç”¨mysqld_safeæ¥å¯åŠ¨MySQLæœåŠ¡ã€‚
- mysql_multiï¼šæœåŠ¡å™¨å¯åŠ¨è„šæœ¬ï¼Œå¯ä»¥å¯åŠ¨æˆ–åœæ­¢ç³»ç»Ÿä¸Šå®‰è£…çš„å¤šä¸ªæœåŠ¡ã€‚
- myiasmchkï¼šç”¨æ¥æè¿°ã€æ£€æŸ¥ã€ä¼˜åŒ–å’Œç»´æŠ¤MyISAMè¡¨çš„å®ç”¨å·¥å…·ã€‚
- mysqlbuï¼šMySQLç¼ºé™·æŠ¥å‘Šè„šæœ¬ã€‚å®ƒå¯ä»¥ç”¨æ¥å‘MySQLé‚®ä»¶ç³»ç»Ÿå‘é€ç¼ºé™·æŠ¥å‘Šã€‚
- mysql_install_dbï¼šç”¨äºé»˜è®¤æƒé™åˆ›å»ºMySQæˆæƒè¡¨ã€‚é€šå¸¸åªæ˜¯åœ¨ç³»ç»Ÿä¸Šé¦–æ¬¡å®‰è£…MySQLæ—¶æ‰§è¡Œä¸€æ¬¡ã€‚

> MySQLå®¢æˆ·ç«¯å·¥å…·

- mysqlï¼šäº¤äº’å¼è¾“å…¥SQLè¯­å¥æˆ–ä»æ–‡ä»¶ä»¥æ‰¹å¤„ç†æ¨¡å¼æ‰§è¡ŒSQLè¯­å¥æ¥æ“ä½œæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œå°±æ˜¯æˆ‘ä»¬çš„å®¢æˆ·ç«¯ã€‚
- mysqldumpï¼šå°†MySQLæ•°æ®åº“è½¬å‚¨åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥ç”¨æ¥å¤‡ä»½æ•°æ®åº“ã€‚
- mysqladminï¼šç”¨æ¥æ£€ç´¢ç‰ˆæœ¬ã€è¿›ç¨‹ã€ä»¥åŠæœåŠ¡å™¨çš„çŠ¶æ€ä¿¡æ¯ã€‚
- mysqlbinlogï¼šç”¨äºä»äºŒè¿›åˆ¶æ—¥å¿—è¯»å–è¯­å¥ã€‚åœ¨äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ä¸­åŒ…å«æ‰§è¡Œçš„è¯­å¥ï¼Œå¯ç”¨æ¥å¸®åŠ©ç³»ç»Ÿä»å´©æºƒä¸­æ¢å¤ã€‚
- mysqlcheckï¼šæ£€æŸ¥ã€ä¿®å¤ã€åˆ†æä»¥åŠä¼˜åŒ–è¡¨çš„è¡¨ç»´æŠ¤ã€‚
- mysqlhotcopyï¼šå½“æœåŠ¡å™¨åœ¨è¿è¡Œæ—¶ï¼Œå¿«é€Ÿå¤‡ä»½MyISAMæˆ–ISAMè¡¨çš„å·¥å…·ã€‚
- mysql importï¼šä½¿ç”¨load data infileå°†æ–‡æœ¬æ–‡ä»¶å¯¼å…¥ç›¸å…³è¡¨çš„å®¢æˆ·ç¨‹åºã€‚
- perrorï¼šæ˜¾ç¤ºç³»ç»Ÿæˆ–MySQLé”™è¯¯ä»£ç å«ä¹‰çš„å·¥å…·ã€‚
- myisampackï¼šå‹ç¼©MyISAPè¡¨ï¼Œäº§ç”Ÿæ›´å°çš„åªè¯»è¡¨ã€‚
- mysaqlaccessï¼šæ£€æŸ¥è®¿é—®ä¸»æœºåã€ç”¨æˆ·åå’Œæ•°æ®åº“ç»„åˆçš„æƒé™ã€‚

```sh
mysql -h 124.220.197.17 -P 3306 -uroot -p  --è¿æ¥æœ¬æœºæˆ–è¿œç¨‹mysql
```

```sql
-- å¤‡ä»½ä¸€ä¸ªè¡¨
mysqldump -u root -p ydlclass ydl_user  > ~/dump.txt
-- å¤‡ä»½ä¸€ä¸ªæ•°æ®åº“
mysqldump -u root -p ydlclass  > ~/dump.txt
-- å¤‡ä»½æ‰€æœ‰æ•°æ®åº“
mysqldump -u root -p   --all-databases > dump.txt
--æ¢å¤æ•°æ®
mysql -u root -p ydl < ~/dump.txt
```

##### 	å­—ç¬¦é›†å’Œæ’åºè§„åˆ™

ã€show collationã€‘å‘½ä»¤å¯ä»¥æŸ¥çœ‹mysqlæ”¯æŒçš„æ‰€æœ‰çš„æ’åºè§„åˆ™å’Œå­—ç¬¦é›†ï¼Œå¦‚ä¸‹æ‰€ç¤ºéƒ¨åˆ†ï¼š

ä¸¾ä¸ªä¾‹å­ï¼š

- utf8-polish-ciï¼Œè¡¨ç¤ºutf-8çš„å­—ç¬¦é›†çš„æ³¢å…°è¯­çš„æ¯”è¾ƒè§„åˆ™ï¼Œciä»£è¡¨å¿½ç•¥å¤§å°å†™ã€‚
- utf8-general-ciï¼Œå°±æ˜¯é€šç”¨çš„å¿½ç•¥å¤§å°å†™çš„utf8å­—ç¬¦é›†æ¯”è¾ƒè§„åˆ™ã€‚
- utf8mb4_0900_ai_ciä¸­çš„0900æŒ‡çš„æ˜¯Unicode 9.0çš„è§„èŒƒï¼Œåè¾¹çš„åç¼€ä»£è¡¨ä¸åŒºåˆ†é‡éŸ³ä¹Ÿä¸åŒºåˆ†å¤§å°å†™ï¼Œä»–æ˜¯utf8mb4å­—ç¬¦é›†ä¸€ä¸ªæ–°çš„é€šç”¨æ’åºå½’åˆ™ã€‚

| åç¼€   | è‹±æ–‡                 | æè¿°             |
| ---- | ------------------ | -------------- |
| _ai  | accent insensitive | ä¸åŒºåˆ†é‡éŸ³ï¼ˆÃ¨ï¼ŒÃ©ï¼ŒÃªå’ŒÃ«ï¼‰ |
| _as  | accent sensitive   | åŒºåˆ†é‡éŸ³           |
| _ci  | case insensitive   | ä¸åŒºåˆ†å¤§å°å†™         |
| _cs  | case sensitive     | åŒºåˆ†å¤§å°å†™          |
| _bin | binary             | ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¿›è¡Œæ¯”è¾ƒ    |

utf8å’Œutf8mb4çš„åŒºåˆ«ï¼š

- utf8mb3(utf-8)ï¼šä½¿ç”¨1~3ä¸ªå­—èŠ‚è¡¨ç¤ºå­—ç¬¦ï¼Œutf8é»˜è®¤å°±æ˜¯utf8mb3ã€‚
- utf8mb4ï¼šä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºå­—ç¬¦ï¼Œä»–æ˜¯utf8çš„è¶…é›†ï¼Œç”šè‡³å¯ä»¥å­˜å‚¨å¾ˆå¤šã€emojiè¡¨æƒ…ğŸ˜€ğŸ˜ƒğŸ˜„ğŸ˜ğŸ˜†ã€‘ï¼Œmysql8.0å·²ç»é»˜è®¤å­—ç¬¦é›†è®¾ç½®ä¸ºutf8mb4ã€‚

mysqlæä¾›ä¸¤ä¸ªå˜é‡ï¼Œè¿›è¡Œå…¨å±€è®¾ç½®ã€‚ã€character_set_serverã€‘å’Œã€collate_serverã€‘å¯¹å…¨å±€çš„å­—ç¬¦é›†å’Œæ’åºè§„åˆ™è¿›è¡Œè®¾ç½®ã€‚è¿™ä¸¤ä¸ªè®¾ç½®å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ã€‚

```sql
-- æŒ‡å®šæ•°æ®åº“
create database æ•°æ®åº“å character set å­—ç¬¦é›†  collate æ¯”è¾ƒè§„åˆ™
create table è¡¨å(
	åˆ—å åˆ—ç±»å‹ 
) character set å­—ç¬¦é›† collate æ¯”è¾ƒè§„åˆ™
create table è¡¨å(
	åˆ—å åˆ—ç±»å‹ [character set å­—ç¬¦é›†] [collate æ¯”è¾ƒè§„åˆ™]
)
```

##### mysqlä¿®æ”¹é…ç½®æ–‡ä»¶çš„æ–¹æ³•

#### I/Oå’Œå­˜å‚¨

æ‰§è¡Œsqlæˆæœ¬

- I/Oæˆæœ¬ï¼šæˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„MyIsamå’ŒInnoDBå­˜å‚¨å¼•æ“éƒ½æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå½“æŸ¥è¯¢è¡¨ä¸­çš„è®°å½•æ—¶ï¼Œéœ€è¦å…ˆå°†æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶åè¿›è¡Œæ“ä½œï¼Œè¿™ä¸ªä»ç£ç›˜åˆ°å†…å­˜çš„åŠ è½½è¿‡ç¨‹æŸè€—çš„æ—¶é—´æˆä¸ºI/Oæˆæœ¬ã€‚
- CPUæˆæœ¬ï¼šè¯»å–è®°å½•ä»¥åŠæ£€æµ‹è®°å½•æ˜¯å¦æ»¡è¶³å¯¹åº”çš„æœç´¢æ¡ä»¶ã€å¯¹ç»“æœé›†è¿›è¡Œæ’åºç­‰è¿™äº›æ“ä½œæ‰€æ¶ˆè€—çš„æ—¶é—´ç§°ä¹‹ä¸ºCPUæˆæœ¬ã€‚

##### I/Oæˆæœ¬

ç£ç›˜ç»“æ„

![](https://www.ydlclass.com/doc21xnv/assets/image-20201122150129276-837e618f.png)

ç›˜ç‰‡ã€ç‰‡é¢å’Œç£å¤´ï¼šç¡¬ç›˜ä¸­ä¸€èˆ¬ä¼šæœ‰å¤šä¸ªã€ç›˜ç‰‡ã€‘ç»„æˆï¼Œæ¯ä¸ªç›˜ç‰‡åŒ…å«ã€ä¸¤ä¸ªé¢ã€‘ï¼Œæ¯ä¸ªç›˜é¢éƒ½å¯¹åº”çš„æœ‰ä¸€ä¸ªã€è¯»/å†™ç£å¤´ã€‘ã€‚å—åˆ°ç¡¬ç›˜æ•´ä½“ä½“ç§¯å’Œç”Ÿäº§æˆæœ¬çš„é™åˆ¶ï¼Œç›˜ç‰‡æ•°é‡éƒ½å—åˆ°é™åˆ¶ï¼Œä¸€èˆ¬éƒ½åœ¨5ç‰‡ä»¥å†…ã€‚ç›˜ç‰‡çš„ç¼–å·ã€è‡ªä¸‹å‘ä¸Šã€‘ä»0å¼€å§‹ï¼Œå¦‚æœ€ä¸‹è¾¹çš„ç›˜ç‰‡æœ‰0é¢å’Œ1é¢ï¼Œå†ä¸Šä¸€ä¸ªç›˜ç‰‡å°±ç¼–å·ä¸º2é¢å’Œ3é¢ã€‚

![](https://www.ydlclass.com/doc21xnv/assets/image-20220424195930213-55095177.png)

æ‰‡åŒºå’Œç£é“ï¼šä¸‹å›¾æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªç›˜é¢ï¼Œç›˜é¢ä¸­ä¸€åœˆåœˆç°è‰²åŒå¿ƒåœ†ä¸ºä¸€æ¡æ¡ç£é“ï¼Œä»åœ†å¿ƒå‘å¤–ç”»ç›´çº¿ï¼Œå¯ä»¥å°†ç£é“åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå¼§æ®µï¼Œæ¯ä¸ªç£é“ä¸Šä¸€ä¸ªå¼§æ®µè¢«ç§°ä¹‹ä¸ºä¸€ä¸ªæ‰‡åŒºï¼ˆå›¾è·µç»¿è‰²éƒ¨åˆ†ï¼‰ã€‚æ‰‡åŒºæ˜¯ç£ç›˜çš„æœ€å°ç»„æˆå•å…ƒï¼Œé€šå¸¸æ˜¯512å­—èŠ‚ã€‚ï¼ˆç”±äºä¸æ–­æé«˜ç£ç›˜çš„å¤§å°ï¼Œéƒ¨åˆ†å‚å•†è®¾å®šæ¯ä¸ªæ‰‡åŒºçš„å¤§å°æ˜¯4096å­—èŠ‚ï¼‰ï¼›

![](https://www.ydlclass.com/doc21xnv/assets/image-20220424195949755-9516f689.png)

ç£å¤´å’ŒæŸ±é¢ï¼šç¡¬ç›˜é€šå¸¸ç”±é‡å çš„ä¸€ç»„ç›˜ç‰‡æ„æˆï¼Œæ¯ä¸ªç›˜é¢éƒ½è¢«åˆ’åˆ†ä¸ºæ•°ç›®ç›¸ç­‰çš„ç£é“ï¼Œå¹¶ä»å¤–ç¼˜çš„â€œ0â€å¼€å§‹ç¼–å·ï¼Œå…·æœ‰ç›¸åŒç¼–å·çš„ç£é“å½¢æˆä¸€ä¸ªåœ†æŸ±ï¼Œç§°ä¹‹ä¸ºç£ç›˜çš„æŸ±é¢ã€‚ç£ç›˜çš„æŸ±é¢æ•°ä¸ä¸€ä¸ªç›˜é¢ä¸Šçš„ç£é“æ•°æ˜¯ç›¸ç­‰çš„ã€‚ç”±äºæ¯ä¸ªç›˜é¢éƒ½æœ‰è‡ªå·±çš„ç£å¤´ï¼Œå› æ­¤ï¼Œç›˜é¢æ•°ç­‰äºæ€»çš„ç£å¤´æ•°ã€‚ å¦‚ä¸‹å›¾

![](https://www.ydlclass.com/doc21xnv/assets/image-20220425153537739-a5e991d6.png)

ç£ç›˜å®¹é‡è®¡ç®—

- å­˜å‚¨å®¹é‡ ï¼ ç£å¤´æ•° Ã— ç£é“(æŸ±é¢)æ•° Ã— æ¯é“æ‰‡åŒºæ•° Ã— æ¯æ‰‡åŒºå­—èŠ‚æ•°

- æœ‰äº›ã€å¤è€ç¡¬ç›˜ã€‘æ¯ä¸ªç£é“çš„æ‰‡åŒºæ•°ä¸€æ ·ï¼Œå¤–åœˆçš„å¯†åº¦å°ï¼Œå†…åœˆçš„å¯†åº¦å¤§ï¼Œæ¯åœˆå¯å­˜å‚¨çš„æ•°æ®é‡æ˜¯ä¸€æ ·çš„ã€‚ç°åœ¨çš„ç¡¬ç›˜æ•°æ®çš„å¯†åº¦éƒ½ä¸€è‡´ï¼Œè¿™æ ·ç£é“çš„å‘¨é•¿è¶Šé•¿ï¼Œæ‰‡åŒºå°±è¶Šå¤šï¼Œå­˜å‚¨çš„æ•°æ®é‡å°±è¶Šå¤§


ç£ç›˜è¯»å–å“åº”æ—¶é—´

1. å¯»é“æ—¶é—´ï¼šç£å¤´ä»å¼€å§‹ç§»åŠ¨åˆ°æ•°æ®æ‰€åœ¨ç£é“æ‰€éœ€è¦çš„æ—¶é—´ï¼Œå¯»é“æ—¶é—´è¶ŠçŸ­ï¼ŒI/Oæ“ä½œè¶Šå¿«ï¼Œç›®å‰ç£ç›˜çš„å¹³å‡å¯»é“æ—¶é—´ä¸€èˆ¬åœ¨3ï¼15msï¼Œä¸€èˆ¬éƒ½åœ¨10mså·¦å³ã€‚
2. æ—‹è½¬å»¶è¿Ÿï¼šç›˜ç‰‡æ—‹è½¬å°†è¯·æ±‚æ•°æ®æ‰€åœ¨æ‰‡åŒºç§»è‡³è¯»å†™ç£å¤´ä¸‹æ–¹æ‰€éœ€è¦çš„æ—¶é—´ï¼Œæ—‹è½¬å»¶è¿Ÿå–å†³äºç£ç›˜è½¬é€Ÿã€‚æ™®é€šç¡¬ç›˜ä¸€èˆ¬éƒ½æ˜¯7200rpmï¼Œå¤§æ¦‚ä¸€åœˆ8msï¼Œæ…¢çš„5400rpmã€‚
3. æ•°æ®ä¼ è¾“æ—¶é—´ï¼šå®Œæˆä¼ è¾“æ‰€è¯·æ±‚çš„æ•°æ®æ‰€éœ€è¦çš„æ—¶é—´ã€‚ å°ç»“ä¸€ä¸‹ï¼šä»ä¸Šé¢çš„æŒ‡æ ‡æ¥çœ‹ã€å…¶å®æœ€é‡è¦çš„ã€æˆ–è€…è¯´ã€æˆ‘ä»¬æœ€å…³å¿ƒçš„åº”è¯¥åªæœ‰ä¸¤ä¸ªï¼šå¯»é“æ—¶é—´ï¼›æ—‹è½¬å»¶è¿Ÿã€‚

äº¤æ¢å•ä½

ã€å—ã€‘æ˜¯æ“ä½œç³»ç»Ÿä¸­æœ€å°çš„é€»è¾‘å­˜å‚¨å•ä½ï¼Œä»–æ˜¯è™šæ‹Ÿå‡ºæ¥çš„ä¸€ä¸ªå•ä½ã€‚æ“ä½œç³»ç»Ÿä¸ç£ç›˜æ‰“äº¤é“çš„æœ€å°å•ä½æ˜¯ç£ç›˜å—ã€‚æ¯ä¸ªå—å¯ä»¥åŒ…æ‹¬2ã€4ã€8ã€16ã€32ã€64â€¦2çš„næ¬¡æ–¹ä¸ªæ‰‡åŒºã€‚

ä¸ºä»€ä¹ˆä½¿ç”¨ç£ç›˜å—

- è¯»å–æ–¹ä¾¿ï¼šç”±äºæ‰‡åŒºçš„å®¹é‡æ¯”è¾ƒå°ï¼Œæ•°ç›®ä¼—å¤šï¼Œåœ¨å¯»å€æ—¶æ¯”è¾ƒå›°éš¾ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿå°±å°†ç›¸é‚»çš„æ‰‡åŒºç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå—ï¼Œå†å¯¹å—è¿›è¡Œæ•´ä½“çš„æ“ä½œã€‚
- åˆ†ç¦»å¯¹åº•å±‚çš„ä¾èµ–ï¼šæ“ä½œç³»ç»Ÿå¿½ç•¥å¯¹åº•å±‚ç‰©ç†å­˜å‚¨ç»“æ„çš„è®¾è®¡ã€‚é€šè¿‡è™šæ‹Ÿå‡ºæ¥ç£ç›˜å—çš„æ¦‚å¿µï¼Œåœ¨ç³»ç»Ÿä¸­è®¤ä¸ºå—æ˜¯æœ€å°çš„å•ä½ã€‚

æ‰‡åŒºã€å—/ç°‡ã€pageçš„å…³ç³»

1. æ‰‡åŒºï¼š ç¡¬ç›˜çš„æœ€å°è¯»å†™å•å…ƒ
2. å—/ç°‡ï¼š æ˜¯æ“ä½œç³»ç»Ÿé’ˆå¯¹ç¡¬ç›˜è¯»å†™çš„æœ€å°å•å…ƒ
3. pageï¼š æ˜¯å†…å­˜ä¸æ“ä½œç³»ç»Ÿä¹‹é—´æ“ä½œçš„æœ€å°å•å…ƒ
4. æ‰‡åŒº <= å—/ç°‡ <= page


å±€éƒ¨æ€§åŸç†å’Œç£ç›˜é¢„è¯»

- ç›˜çš„å­˜å–é€Ÿåº¦å¾€å¾€æ˜¯ä¸»å­˜çš„ã€åä¸‡åˆ†ä¹‹ä¸€ã€‘ï¼Œå› æ­¤ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¦ã€å°½é‡å‡å°‘ç£ç›˜I/Oã€‘ã€‚ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œç£ç›˜å¾€å¾€ä¸æ˜¯ä¸¥æ ¼çš„ã€æŒ‰éœ€è¯»å–ã€‘ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½ä¼šé¢„è¯»ï¼Œå³ä½¿åªéœ€è¦ä¸€ä¸ªå­—èŠ‚ï¼Œç£ç›˜ä¹Ÿä¼šä»è¿™ä¸ªä½ç½®å¼€å§‹ï¼Œé¡ºåºå‘åè¯»å–ä¸€å®šé•¿åº¦çš„æ•°æ®æ”¾å…¥å†…å­˜ã€‚è¿™æ ·åšçš„ç†è®ºä¾æ®æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­è‘—åçš„å±€éƒ¨æ€§åŸç†ã€‚

- å±€éƒ¨æ€§åŸç†ï¼šå½“ä¸€ä¸ªæ•°æ®è¢«ç”¨åˆ°æ—¶ï¼Œå…¶é™„è¿‘çš„æ•°æ®ä¹Ÿé€šå¸¸ä¼šé©¬ä¸Šè¢«ä½¿ç”¨ï¼Œç¨‹åºè¿è¡ŒæœŸé—´æ‰€éœ€è¦çš„æ•°æ®é€šå¸¸æ¯”è¾ƒé›†ä¸­ã€‚

- ç”±äºç£ç›˜ã€é¡ºåºè¯»å–ã€‘çš„æ•ˆç‡å¾ˆé«˜ï¼ˆä¸éœ€è¦å¯»é“æ—¶é—´ï¼Œåªéœ€å¾ˆå°‘çš„æ—‹è½¬æ—¶é—´ï¼‰ï¼Œå› æ­¤å¯¹äºå…·æœ‰å±€éƒ¨æ€§çš„ç¨‹åºæ¥è¯´ï¼Œé¢„è¯»å¯ä»¥æé«˜I/Oæ•ˆç‡ã€‚
- é¢„è¯»çš„é•¿åº¦ä¸€èˆ¬ä¸ºã€é¡µï¼ˆpageï¼‰ã€‘çš„æ•´å€æ•°ï¼ˆåœ¨è®¸å¤šæ“ä½œç³»ç»Ÿä¸­ï¼Œé¡µå¾—å¤§å°é€šå¸¸ä¸º4kï¼‰ã€‚å½“ç¨‹åºè¦è¯»å–çš„æ•°æ®ä¸åœ¨ä¸»å­˜ä¸­æ—¶ï¼Œä¼šè§¦å‘ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šå‘ç£ç›˜å‘å‡ºè¯»ç›˜ä¿¡å·ï¼Œç£ç›˜ä¼šæ‰¾åˆ°æ•°æ®çš„èµ·å§‹ä½ç½®å¹¶å‘åè¿ç»­è¯»å–ä¸€é¡µæˆ–å‡ é¡µè½½å…¥å†…å­˜ä¸­ï¼Œç„¶åå¼‚å¸¸è¿”å›ï¼Œç¨‹åºç»§ç»­è¿è¡Œã€‚

##### æ•°æ®å­˜å‚¨

æ•°æ®æ˜¯å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ï¼Œä¸åŒçš„å­˜å‚¨å­˜å‚¨å¼•æ“ä¼šæœ‰ä¸åŒçš„æ–‡ä»¶æ ¼å¼å’Œç»„ç»‡å½¢å¼

innodbæ•°æ®å­˜å‚¨

å¯¹äºinnodbè€Œè¨€ï¼Œæ•°æ®æ˜¯å­˜å‚¨åœ¨è¡¨ç©ºé—´ï¼ˆæ–‡ä»¶ç©ºé—´file spaceï¼‰å†…çš„ï¼Œè¡¨ç©ºé—´æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œä»–å¯¹åº”ç€ç¡¬ç›˜ä¸Šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾

![](https://www.ydlclass.com/doc21xnv/assets/image-20220427104757135-00dc235b.png)

è¡¨ç©ºé—´å­˜å‚¨æ•°æ®çš„å•ä½æ˜¯ã€é¡µã€‘ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç±»æ¯”ï¼Œä¸€ä¸ªè¡¨ç©ºé—´å°±æ˜¯ä¸ªå¤§å¤§çš„æœ¬å­ï¼Œæœ¬å­é‡Œæ˜¯ä¸€é¡µé¡µçš„æ•°æ®ï¼ˆinnodbæ˜¯ä»¥é¡µä¸ºå•ä½è¿›è¡Œæ•°æ®å­˜å‚¨çš„ï¼‰ï¼Œå¸¸ç”¨é¡µé¢ç±»å‹æœ‰å¾ˆå¤šï¼Œä¸åŒç±»å‹çš„é¡µé¢å¯ä»¥å­˜æ”¾ã€ä¸åŒç±»å‹çš„æ•°æ®ã€‘

- file headerï¼šè®°å½•é¡µé¢çš„ä¸€äº›é€šç”¨ä¿¡æ¯ï¼Œæ¯”å¦‚å½“å‰é¡µçš„æ ¡éªŒå’Œã€é¡µå·ã€ä¸Šé¡µå·ã€ä¸‹é¡µå·ã€æ‰€å±è¡¨ç©ºé—´ç­‰ã€‚
- file trailerï¼šä¸»è¦çš„å·¥ä½œæ˜¯æ£€éªŒé¡µæ˜¯å¦å®Œæ•´ã€‚
- è¡¨ç©ºé—´ä¸­çš„æ¯ä¸€ä¸ªé¡µï¼Œéƒ½æœ‰ä¸€ä¸ªé¡µå·ï¼ˆFile_PAGE_OFFSETï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªé¡µå·åœ¨è¡¨ç©ºé—´å¿«é€Ÿå®šä½åˆ°æŒ‡å®šçš„é¡µé¢ã€‚è¿™ä¸ªé¡µå·ç”±4ä¸ªå­—èŠ‚ç»„æˆï¼Œä¹Ÿå°±æ˜¯32ä½ï¼Œæ‰€æœ‰æœ€å¤šèƒ½å­˜æ”¾2çš„32æ¬¡æ–¹é¡µï¼Œå¦‚æœæŒ‰ç…§ä¸€é¡µ16kè®¡ç®—ï¼Œä¸€ä¸ªè¡¨ç©ºé—´æœ€å¤§æ”¯æŒã€64TBã€‘çš„æ•°æ®ã€‚æ•´ä½“çš„æ’åˆ—ä¸­é¡µæ˜¯è¿ç»­çš„ï¼Œä½†æ˜¯é¡µæœ‰ä¸Šä¸‹æŒ‡é’ˆï¼Œä¸è¿ç»­çš„é¡µä¹Ÿèƒ½ç»„æˆé“¾è¡¨ã€‚



#### MySQLä¸´æ—¶è¡¨

##### ä¸´æ—¶è¡¨ç®€ä»‹

ç”¨æˆ·è‡ªå·±åˆ›å»ºçš„ä¸´æ—¶è¡¨ç”¨äºã€ä¿å­˜ä¸´æ—¶æ•°æ®ã€‘ï¼Œä»¥åŠMySQLå†…éƒ¨åœ¨æ‰§è¡Œã€å¤æ‚SQLã€‘æ—¶ï¼Œéœ€è¦å€ŸåŠ©ä¸´æ—¶è¡¨è¿›è¡Œã€åˆ†ç»„ã€æ’åºã€å»é‡ã€‘ç­‰æ“ä½œï¼Œä¸´æ—¶è¡¨å…·æœ‰ä¸€ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š

- ä¸´æ—¶è¡¨ä¸èƒ½é€šè¿‡`show tables`æŸ¥çœ‹ï¼Œåœ¨æœåŠ¡å™¨é‡å¯ä¹‹åï¼Œæ‰€æœ‰çš„ä¸´æ—¶è¡¨å°†å…¨éƒ¨è¢«é”€æ¯ã€‚
- ä¸´æ—¶è¡¨æ˜¯æ¯ä¸ªè¿›ç¨‹ç‹¬äº«çš„ï¼Œå½“å‰è¿›ç¨‹ï¼ˆå®¢æˆ·ç«¯ï¼‰åˆ›å»ºçš„ä¸´æ—¶è¡¨ï¼Œå…¶ä»–è¿›ç¨‹ï¼ˆå®¢æˆ·ç«¯ï¼‰æ˜¯æŸ¥ä¸åˆ°ä¸´æ—¶è¡¨é‡Œé¢çš„æ•°æ®çš„ï¼Œæ‰€ä»¥ä¸åŒå®¢æˆ·ç«¯å¯ä»¥åˆ›å»ºåŒåçš„ä¸´æ—¶è¡¨ã€‚

##### ä¸´æ—¶è¡¨åˆ†ç±»

å¤–éƒ¨ä¸´æ—¶è¡¨

```sql
--é€šè¿‡create temporary tableè¯­å¥åˆ›å»ºçš„ä¸´æ—¶è¡¨ä¸ºå¤–éƒ¨ä¸´æ—¶è¡¨
create temporary table temp_table(
	id int,
	name varchar(10)
) ENGINE = InnoDB;
insert into temp_table values (1,'1');
select * from temp_table ;
-- åˆ é™¤ä¸´æ—¶è¡¨
DROP TEMPORARY TABLE table_name;
```

å†…éƒ¨ä¸´æ—¶è¡¨

ç”¨æ¥å­˜å‚¨æŸäº›æ“ä½œçš„ã€ä¸­é—´ç»“æœã€‘ï¼Œè¿™äº›æ“ä½œå¯èƒ½åŒ…æ‹¬åœ¨ã€ä¼˜åŒ–é˜¶æ®µã€‘æˆ–è€…ã€æ‰§è¡Œé˜¶æ®µã€‘ï¼Œè¿™ç§å†…éƒ¨è¡¨å¯¹ç”¨æˆ·æ¥è¯´æ˜¯ä¸å¯è§çš„ã€‚é€šå¸¸åœ¨æ‰§è¡Œå¤æ‚SQLè¯­å¥æ—¶ï¼Œæ¯”å¦‚group byï¼Œdistinctï¼Œunionç­‰è¯­å¥æ—¶ï¼ŒMySQLå†…éƒ¨å°†ä½¿ç”¨ã€è‡ªåŠ¨ç”Ÿæˆçš„ä¸´æ—¶è¡¨ã€‘ï¼Œä»¥è¾…åŠ©SQLçš„æ‰§è¡Œ

groupbyæ‰§è¡Œæµç¨‹

```sql
select age,count(*) from student group by age order by age
```

æµç¨‹

- åˆ›å»ºä¸€ä¸ªå†…éƒ¨ä¸´æ—¶è¡¨ï¼Œæœ‰ä¸¤åˆ—ï¼Œä¸€åˆ—æ˜¯ageï¼Œä¸€åˆ—æ˜¯count(*)ã€‚
- å…¨è¡¨æ‰«æã€åŸå§‹è¡¨ã€‘ï¼ˆèšç°‡ç´¢å¼•ä¼šåœ¨åè¾¹çš„å†…å®¹è®²è§£ï¼‰ï¼Œæ¯æ‰«æä¸€æ¡æ•°æ®è¿›è¡Œä¸€æ¬¡åˆ¤æ–­ï¼Œç¬¬ä¸€ç§æƒ…å†µï¼Œè¿™æ¡æ•°æ®çš„å¹´é¾„åœ¨ä¸´æ—¶è¡¨ä¸­ä¸å­˜åœ¨ï¼Œåˆ™å°†å¹´é¾„å¡«å…¥ï¼Œcountåˆ—å¡«1ã€‚ç¬¬äºŒç§æƒ…å†µï¼Œè¯¥æ¡æ•°æ®åœ¨ä¸´æ—¶è¡¨ä¸­å­˜åœ¨ï¼Œåˆ™å°†countåˆ—åŠ 1ã€‚ä¸´æ—¶è¡¨çš„å­˜åœ¨æ˜¯ä¸ºäº†è¾…åŠ©è®¡ç®—ã€‚
- å¯¹ä¸´æ—¶è¡¨çš„æ•°æ®æŒ‰ç…§å¹´é¾„è¿›è¡Œæ’åºã€‚

![](https://www.ydlclass.com/doc21xnv/assets/image-20220512173136197-67e95f7b.png)

å†…éƒ¨ä¸´æ—¶è¡¨åˆ›å»ºæ—¶æœº

- ä½¿ç”¨GROUP BYåˆ†ç»„ï¼Œä¸”åˆ†ç»„å­—æ®µæ²¡æœ‰ç´¢å¼•æ—¶ã€‚
- ä½¿ç”¨DISTINCTæŸ¥è¯¢ã€‚
- ä½¿ç”¨UNIONè¿›è¡Œç»“æœåˆå¹¶ï¼Œè¾…åŠ©å»é‡ã€‚


ä¸´æ—¶è¡¨è¿˜å¯ä»¥åˆ†ä¸ºã€å†…å­˜ä¸´æ—¶è¡¨ã€‘å’Œã€ç£ç›˜ä¸´æ—¶è¡¨ã€‘ã€‚å†…å­˜ä¸´æ—¶è¡¨ä½¿ç”¨memeryå¼•æ“ï¼ˆMemoryå¼•æ“ä¸æ”¯æŒBOLBå’ŒTEXTç±»å‹ï¼‰ï¼Œç£ç›˜ä¸´æ—¶è¡¨é»˜è®¤ä½¿ç”¨innodbå¼•æ“ã€‚åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µä¸‹ï¼Œä¼šåˆ›å»ºç£ç›˜ä¸´æ—¶è¡¨ï¼š

- æ•°æ®è¡¨ä¸­åŒ…å«BLOB/TEXTåˆ—ï¼›
- åœ¨ GROUP BY æˆ–è€… DSTINCT çš„åˆ—ä¸­æœ‰è¶…è¿‡ 512å­—ç¬¦çš„å­—ç¬¦ç±»å‹åˆ—ï¼›
- åœ¨SELECTã€UNIONã€UNION ALLæŸ¥è¯¢ä¸­ï¼Œå­˜åœ¨æœ€å¤§é•¿åº¦è¶…è¿‡512çš„åˆ—ï¼ˆå¯¹äºå­—ç¬¦ä¸²ç±»å‹æ˜¯512ä¸ªå­—ç¬¦ï¼Œå¯¹äºäºŒè¿›åˆ¶ç±»å‹åˆ™æ˜¯512å­—èŠ‚ï¼‰ï¼›

#### MySQLäº‹åŠ¡

##### äº‹åŠ¡ç®€ä»‹

- é¦–å…ˆç»™å¤§å®¶ä¸¾ä¸€ä¸ªä¾‹å­ï¼šæˆ‘ä»¬æœ‰å¦‚ä¸‹çš„é”€å”®ä¸šåŠ¡ï¼Œä¸€ä¸ªé”€å”®ä¸šåŠ¡å¯èƒ½åŒ…å«å¾ˆå¤šæ­¥éª¤ï¼Œæ¯”å¦‚è®°å½•è®¢å•ã€æ·»åŠ ç§¯åˆ†ã€ç®¡ç†åº“å­˜ã€æ‰£å‡é‡‘é¢ç­‰ç­‰ï¼Œæ¯ä¸€ä¸ªæ“ä½œéƒ½å¯èƒ½å¯¹åº”ä¸€æ¡æˆ–å¤šæ¡sqlè¯­å¥ï¼Œä½†æ˜¯è¿™ä¸ªä¸šåŠ¡å´æ˜¯ä¸å¯åˆ†å‰²çš„ï¼Œä¸èƒ½ä¸‹äº†è®¢å•ï¼Œä¸æ‰£å‡åº“å­˜ã€‚æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦äº‹åŠ¡æ¥ç»Ÿä¸€ç®¡ç†è¿™ä¸ªä¸šåŠ¡å½“ä¸­çš„ä¸€ç³»åˆ—sqlè¯­å¥äº†ã€‚
- åœ¨ MySQL ä¸­åªæœ‰ä½¿ç”¨äº† Innodb æ•°æ®åº“å¼•æ“çš„æ•°æ®åº“æˆ–è¡¨æ‰æ”¯æŒäº‹åŠ¡ã€‚
- äº‹åŠ¡å¤„ç†å¯ä»¥ç”¨æ¥ç»´æŠ¤æ•°æ®åº“çš„å®Œæ•´æ€§ï¼Œä¿è¯æˆæ‰¹çš„ SQL è¯­å¥è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚

##### äº‹åŠ¡åˆ†ç±»

æ˜¾å¼äº‹åŠ¡å’Œéšå¼äº‹åŠ¡

- mysqlçš„äº‹åŠ¡å¯ä»¥åˆ†ä¸ºã€æ˜¾å¼äº‹åŠ¡ã€‘å’Œã€éšå¼äº‹åŠ¡ã€‘ã€‚

- é»˜è®¤çš„äº‹åŠ¡æ˜¯éšå¼äº‹åŠ¡ï¼Œç”±å˜é‡ã€autocommitã€‘æ§åˆ¶ã€‚éšå¼äº‹åŠ¡çš„ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬æ¯æ‰§è¡Œä¸€æ¡sqléƒ½ä¼šã€è‡ªåŠ¨å¼€å¯å’Œå…³é—­ã€‘äº‹åŠ¡ï¼Œå˜é‡å¦‚ä¸‹ï¼šSHOW VARIABLES LIKE 'autocommit';

- æ˜¾å¼äº‹åŠ¡ç”±æˆ‘ä»¬ã€è‡ªå·±æ§åˆ¶ã€‘äº‹åŠ¡çš„ã€å¼€å¯ï¼Œæäº¤ï¼Œå›æ»šã€‘ç­‰æ“ä½œ  

  start transactionã€commitã€rollback

åªè¯»äº‹åŠ¡å’Œè¯»å†™äº‹åŠ¡

- ç”¨read onlyå¼€å¯åªè¯»äº‹åŠ¡ï¼Œå¼€å¯åªè¯»äº‹åŠ¡æ¨¡å¼ä¹‹åï¼Œäº‹åŠ¡æ‰§è¡ŒæœŸé—´ä»»ä½•ã€insertã€‘æˆ–è€…ã€updateã€‘è¯­å¥éƒ½æ˜¯ä¸å…è®¸çš„    start transaction  read only


ä¿å­˜ç‚¹

- ä½¿ç”¨savepoint å…³é”®å­—åœ¨äº‹åŠ¡æ‰§è¡Œä¸­æ–°å»ºã€ä¿å­˜ç‚¹ã€‘ï¼Œä¹‹åå¯ä»¥ä½¿ç”¨rollbackå‘ä»»æ„ä¿å­˜ç‚¹å›æ»šã€‚

  savepoint a ã€rollback to a

- Mysqlæ˜¯ä¸æ”¯æŒåµŒå¥—äº‹åŠ¡çš„ï¼Œå¼€å¯ä¸€ä¸ªäº‹åŠ¡çš„æƒ…å†µä¸‹ï¼Œè‹¥å†å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œä¼šéšå¼çš„æäº¤ä¸Šä¸€ä¸ªäº‹åŠ¡ï¼š


##### äº‹åŠ¡çš„å››å¤§ç‰¹æ€§

- åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡ï¼ˆtransactionï¼‰ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œ**è¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆ**ï¼Œä¸ä¼šç»“æŸåœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ã€‚å¦‚æœäº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œä¼šè¢«å›æ»šï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ä¸€æ ·ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£ã€‚
- ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šåœ¨äº‹åŠ¡ã€å¼€å§‹ä¹‹å‰å’Œç»“æŸä»¥åã€‘ï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ²¡æœ‰è¢«ç ´åï¼Œæ•°æ®åº“çŠ¶æ€åº”è¯¥ä¸ä¸šåŠ¡è§„åˆ™ä¿æŒä¸€è‡´ã€‚**ä¸¾ä¸€ä¸ªä¾‹å­**ï¼šAå‘Bè½¬è´¦ï¼Œä¸å¯èƒ½Aæ‰£äº†é’±ï¼ŒBå´æ²¡æœ‰æ”¶åˆ°ï¼Œä¹Ÿä¸å¯èƒ½Aå’ŒBçš„æ€»é‡‘é¢ï¼Œåœ¨äº‹åŠ¡å‰åå‘ç”Ÿå˜åŒ–ï¼Œäº§ç”Ÿæ•°æ®ä¸ä¸€è‡´ã€‚å…¶ä»–çš„ä¸‰ä¸ªç‰¹æ€§éƒ½åœ¨ä¸ºä»–æœåŠ¡ã€‚
- éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šæ•°æ®åº“ã€å…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹å…¶æ•°æ®è¿›è¡Œè¯»å–å’Œä¿®æ”¹ã€‘ï¼Œéš”ç¦»æ€§å¯ä»¥é˜²æ­¢å¤šä¸ªäº‹åŠ¡åœ¨å¹¶å‘ä¿®æ”¹å…±äº«æ•°æ®æ—¶äº§ç”Ÿã€æ•°æ®ä¸ä¸€è‡´ã€‘çš„ç°è±¡ï¼Œè¿™é‡Œè¦è”æƒ³åˆ°æˆ‘ä»¬å­¦ä¹ è¿‡çš„å¤šçº¿ç¨‹ã€‚äº‹åŠ¡éš”ç¦»çº§åˆ«åˆ†ä¸ºä¸åŒç­‰çº§ï¼ŒåŒ…æ‹¬è¯»æœªæäº¤ï¼ˆRead uncommittedï¼‰ã€è¯»æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ï¼Œåç»­ä¼šè¯¦ç»†è®²ã€‚
- æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡å¤„ç†ç»“æŸåï¼Œå¯¹æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…çš„ï¼Œå³ä¾¿ç³»ç»Ÿæ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±ã€‚

##### äº‹åŠ¡çš„éš”ç¦»çº§åˆ«

|                        |      |       |      |                             |
| ---------------------- | ---- | ----- | ---- | --------------------------- |
| éš”ç¦»çº§åˆ«                   | è„è¯»   | ä¸å¯é‡å¤è¯» | å¹»è¯»   | è§£å†³æ–¹æ¡ˆ                        |
| Read uncommittedï¼ˆè¯»æœªæäº¤ï¼‰ | âˆš    | âˆš     | âˆš    |                             |
| Read committedï¼ˆè¯»å·²æäº¤ï¼‰   | Ã—    | âˆš     | âˆš    | undo log                    |
| Repeatable readï¼ˆå¯é‡å¤è¯»ï¼‰  | Ã—    | Ã—     | âˆš    | MVCCç‰ˆæœ¬æ§åˆ¶+é—´éš™é”ï¼ˆmysqlçš„rrä¸å­˜åœ¨å¹»è¯»ï¼‰ |
| Serializableï¼ˆä¸²è¡ŒåŒ–ï¼‰      | Ã—    | Ã—     | Ã—    |                             |

```
-- æŸ¥çœ‹å…¨å±€å’Œå½“å‰äº‹åŠ¡çš„éš”ç¦»çº§åˆ«
SELECT @@global.transaction_isolation
show variables like 'transaction_isolation';

-- è®¾ç½®ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„éš”ç¦»çº§åˆ«
SET transaction isolation level read uncommitted;
SET transaction isolation level read committed;
set transaction isolation level repeatable read;
SET transaction isolation level serializable;
-- è®¾ç½®å½“å‰ä¼šè¯çš„éš”ç¦»çº§åˆ«
SET session transaction isolation level read uncommitted;
SET session transaction isolation level read committed;
set session transaction isolation level repeatable read;
SET session transaction isolation level serializable;
-- è®¾ç½®å…¨å±€äº‹åŠ¡çš„éš”ç¦»çº§åˆ«
SET GLOBAL transaction isolation level read uncommitted;
SET GLOBAL transaction isolation level read committed;
set GLOBAL transaction isolation level repeatable read;
SET GLOBAL transaction isolation level serializable;
å…¶ä¸­ï¼ŒSESSION å’Œ GLOBAL å…³é”®å­—ç”¨æ¥æŒ‡å®šä¿®æ”¹çš„äº‹åŠ¡éš”ç¦»çº§åˆ«çš„èŒƒå›´ï¼š
SESSIONï¼šè¡¨ç¤ºä¿®æ”¹çš„äº‹åŠ¡éš”ç¦»çº§åˆ«å°†åº”ç”¨äºå½“å‰ sessionï¼ˆå½“å‰ cmd çª—å£ï¼‰å†…çš„æ‰€æœ‰äº‹åŠ¡ï¼›
GLOBALï¼šè¡¨ç¤ºä¿®æ”¹çš„äº‹åŠ¡éš”ç¦»çº§åˆ«å°†åº”ç”¨äºæ‰€æœ‰ sessionï¼ˆå…¨å±€ï¼‰ä¸­çš„æ‰€æœ‰äº‹åŠ¡ï¼Œä¸”å½“å‰å·²ç»å­˜åœ¨çš„ session ä¸å—å½±å“ï¼›
å¦‚æœçœç•¥ SESSION å’Œ GLOBALï¼Œè¡¨ç¤ºä¿®æ”¹çš„äº‹åŠ¡éš”ç¦»çº§åˆ«å°†åº”ç”¨äºå½“å‰ session å†…çš„ä¸‹ä¸€ä¸ªè¿˜æœªå¼€å§‹çš„äº‹åŠ¡ã€‚
```

è¯»æœªæäº¤ï¼ˆread uncommittedï¼‰

- ä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–å…¶ä»–ã€æœªæäº¤çš„äº‹åŠ¡ã€‘ä¿®æ”¹çš„æ•°æ®ï¼Œè¿™ç§éš”ç¦»çº§åˆ«æœ€ä½ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ•°æ®åº“éš”ç¦»çº§åˆ«éƒ½è¦é«˜äºè¯¥çº§åˆ«ï¼Œè¯¥éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¯èƒ½ä¼šå­˜åœ¨è„è¯»ã€ä¸å¯é‡å¤åº¦ï¼Œå¹»è¯»çš„é—®é¢˜ã€‚

- è„è¯»ï¼šæŒ‡çš„æ˜¯ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼Œæœªæäº¤æ„å‘³ç€è¿™äº›æ•°æ®å¯èƒ½ä¼šå›æ»šï¼Œè¯»åˆ°çš„æ•°æ®ä¸ä¸€å®šå‡†ç¡®ã€‚


è¯»å·²æäº¤ï¼ˆread committedï¼‰

- å½“å‰äº‹åŠ¡åªèƒ½è¯»åˆ°åˆ«çš„äº‹ç‰©å·²ç»æäº¤çš„æ•°æ®ï¼Œè¯¥éš”ç¦»çº§åˆ«å¯èƒ½ä¼šäº§ç”Ÿä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚

- ä¸å¯é‡å¤è¯»ï¼šã€ä¸€ä¸ªäº‹åŠ¡ã€‘ï¼ˆAäº‹åŠ¡ï¼‰ä¿®æ”¹äº†ã€å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ã€‘ï¼ˆBäº‹åŠ¡ï¼‰è¯»å–è¿‡çš„æ•°æ®ã€‚é‚£ä¹ˆBäº‹åŠ¡ã€å†æ¬¡è¯»å–ã€‘ï¼Œä¼šå‘ç°ä¸¤æ¬¡è¯»å–çš„æ•°æ®ä¸ä¸€è‡´ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œä¸­ä¸€ä¸ªäº‹åŠ¡ä¸¤æ¬¡è¯»å–ç›¸åŒçš„æ•°æ®ï¼Œå´ä¸ä¸€è‡´ï¼Œä¸€è¡Œæ•°æ®ä¸èƒ½é‡å¤è¢«è¯»å–ã€‚ä¸»è¦æ˜¯ã€updateã€‘è¯­å¥ï¼Œä¼šå¯¼è‡´ä¸å¯é‡å¤è¯»ã€‚

å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰

- åŒä¸€ä¸ªäº‹åŠ¡ä¸­å‘å‡ºåŒä¸€ä¸ªSELECTè¯­å¥ã€ä¸¤æ¬¡æˆ–æ›´å¤šæ¬¡ã€‘ï¼Œé‚£ä¹ˆäº§ç”Ÿçš„ç»“æœæ•°æ®é›†æ€»æ˜¯ç›¸åŒçš„ï¼Œåœ¨RRéš”ç¦»çº§åˆ«ä¸­å¯èƒ½å‡ºç°å¹»è¯»ã€‚

- å¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡æŒ‰ç…§æŸäº›æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢ï¼Œäº‹åŠ¡æäº¤å‰ï¼Œæœ‰å¦ä¸€ä¸ªäº‹åŠ¡æ’å…¥äº†æ»¡è¶³æ¡ä»¶çš„å…¶ä»–æ•°æ®ï¼Œå†æ¬¡ä½¿ç”¨ç›¸åŒæ¡ä»¶æŸ¥è¯¢ï¼Œå´å‘ç°å¤šäº†ä¸€äº›æ•°æ®ï¼Œå°±åƒå‡ºç°äº†å¹»è§‰ä¸€æ ·ã€‚å¹»è¯»ä¸»è¦é’ˆå¯¹é’ˆå¯¹deleteå’Œinsertè¯­å¥ã€‚

- ä¸å¯é‡å¤è¯»å¼ºè°ƒçš„æ˜¯ä¸¤æ¬¡è¯»å–çš„æ•°æ®ã€å†…å®¹ä¸åŒã€‘ï¼Œå¹»è¯»å‰è°ƒçš„æ˜¯ä¸¤æ¬¡è¯»å–çš„ã€è¡Œæ•°ä¸åŒã€‘ã€‚


ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰

- äº‹åŠ¡Aå’Œäº‹åŠ¡Bï¼Œäº‹åŠ¡Aåœ¨æ“ä½œæ•°æ®åº“æ—¶ï¼Œäº‹åŠ¡Båªèƒ½æ’é˜Ÿç­‰å¾…
- è¿™ç§éš”ç¦»çº§åˆ«å¾ˆå°‘ä½¿ç”¨ï¼Œååé‡å¤ªä½ï¼Œç”¨æˆ·ä½“éªŒå·®
- è¿™ç§çº§åˆ«å¯ä»¥é¿å…â€œå¹»è¯»â€ï¼Œæ¯ä¸€æ¬¡è¯»å–çš„éƒ½æ˜¯æ•°æ®åº“ä¸­çœŸå®å­˜åœ¨æ•°æ®ï¼Œäº‹åŠ¡Aä¸äº‹åŠ¡Bä¸²è¡Œï¼Œè€Œä¸å¹¶å‘ã€‚